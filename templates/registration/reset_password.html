{% extends "registration/base.html" %}
{% load i18n static %}

{% block main %}
<div id="content-main" class='grid'>

	<form method="post" class='grid p-2 place-content-center'>{% csrf_token %}
		<div class='grid gap-4'>
			{% if form.errors %}
				<p class="text-red-500">
				{% blocktranslate count counter=form.errors.items|length %}Please correct the error below.{% plural %}Please correct the errors below.{% endblocktranslate %}
				</p>
			{% endif %}
      
      {% if stage %}
        {% if stage == 'request' %}
        <p class='font-bold '>{% translate 'Please enter your username.' %}</p>
        <fieldset class="grid gap-2">
            {{ form.as_div }}
        </fieldset>
        
          
        {% elif stage == 'reset' %}
        <div class='w-5/6 place-self-center'><p class='font-bold text-sm'>{% translate 'Please enter the OTP, for securityâ€™s sake.<br>Then enter your new password twice so we can verify you typed it in correctly.' %}</p></div>
        <fieldset class='grid gap-2'>
          <div class="grid gap-2">
            {{ form.otp.errors }}
            <div class="grid gap-2">{{ form.otp.label_tag }} {{ form.otp }}</div>
          </div>

          <div class="grid gap-2">
            {{ form.new_password.errors }}
            <div class="grid gap-2">{{ form.new_password.label_tag }} {{ form.new_password }}</div>
            {% if form.new_password.help_text %}
            <div class="text-sm"{% if form.new_password1.id_for_label %} id="{{ form.new_password1.id_for_label }}_helptext"{% endif %}>{{ form.new_password.help_text|safe }}</div>
            {% endif %}
          </div>

          <div class="grid gap-2">
            {{ form.new_password2.errors }}
            <div class="grid gap-2">{{ form.new_password2.label_tag }} {{ form.new_password2 }}</div>
            {% if form.new_password2.help_text %}
            <div class="help"{% if form.new_password2.id_for_label %} id="{{ form.new_password2.id_for_label }}_helptext"{% endif %}>{{ form.new_password2.help_text|safe }}</div>
            {% endif %}
          </div>

        </fieldset>
        <button ><a href='{% url "request_otp" %}'>Request New OTP</a></button>
        {% endif %}
      {% endif %}
                  
			</fieldset>

			<div class="grid place-self-center border-2 rounded-md p-4 w-fit">
				<input type="submit" value="{% translate 'Submit' %}" class="default">
			</div>

		</div>
	</form>
</div>

{% endblock %}
