{% extends 'teaching_practice/base_site.html' %} 
{% load tz %}
{% block main %}
<div class="grid w-full h-full place-self-start gap-1">
	<div class="flex flex-col w-full gap-2">
		<form class='place-self-center mr-4' action='{% url "assessments-export" %}' method='get'>
      <button class='shadow-2xl p-4 rounded-2xl font-bold border'>Proceed to export CSV of {{ name }} as shown below</button>
    </form>
		<table class="w-5/6 place-self-center border">
			<caption class=''>{{ name }}</caption>
			<thead class="border-b bg-gray-500 text-white p-2">
				<tr class="">
					
					<th class="px-2">Full Name</th>
					<th class="px-2">Assessment Number</th>
					<th class="px-2">Zone</th>
					
					{% for i in max_items %}
						<th class="px-2">Assessment {{ forloop.counter }}</th>
						<th class="px-2">Assessment {{ forloop.counter }} Type</th>
						<th class="px-2">Assessment {{ forloop.counter }} Assessor</th>
						<th class="px-2">Assessment {{ forloop.counter }} Date & Time</th>
					{% endfor %}
				</tr>
			</thead>

			{% if page_obj %}
			<tbody class="">
				{% for letter in page_obj %}

				<tr
					class="{% cycle 'bg-gray-200 dark:text-black' 'bg-inherit' %} text-{% cycle 'bg-black' 'inherit' %} hover:bg-[#333] hover:text-white">
					<td class="px-2">{{ letter.name }}</td>
					<td class="px-2">{{ letter.index }}</td>
					<td class="px-2">{{ letter.zone }}</td>
					
					{% for total_score, assessment_type, assessor, created_at in letter.assessments %}
						<td class="px-2">{{ total_score }}</td>
						<td class="px-2">{{ assessment_type.name }}</td>
						<td class="px-2">{{ assessor }}</td>
						<td class="px-2">{{ created_at|localtime|date }} {{ created_at|localtime|time }}</td>
					{% endfor %}
				</tr>
				{% endfor %}
			</tbody>
			<tfoot class="bg-gray-500 text-white font-bold">
				<tr class="">
					<td colspan='12' class=''>
						<p class='w-full grid grid-flow-col'>
							<span class='text-left'>Showing {{ page_obj.object_list|length }} of {{ page_obj.paginator.count }} Student Assessments</span>
							<span class='text-right'>
								{% with request.GET.urlencode as query_params %}
									{% if query_params %}
										{% if page_obj.has_previous %}
											<a
												class="px-2"
												href="?{{ query_params }}&page={{ page_obj.previous_page_number }}">
												Previous
											</a>
										{% endif %}
										PAGE: {{ page_obj.number }} of
										<a
											class="px-2"
											href="?{{ query_params }}&page={{ page_obj.paginator.num_pages }}">
											{{ page_obj.paginator.num_pages }}
										</a>
												{% if page_obj.has_next %}
														<a href="?{{ query_params }}&page={{ page_obj.next_page_number }}">Next</a>
												{% endif %}
										{% else %}
											{% if page_obj.has_previous %}
												<a
													class="px-2"
													href="?{{ query_params }}&page={{ page_obj.previous_page_number }}">
													Previous
												</a>
											{% endif %}
												PAGE: {{ page_obj.number }} of
												<a
													class="px-2"
													href="?page={{ page_obj.paginator.num_pages }}">
													{{ page_obj.paginator.num_pages }}
												</a>
											{% if page_obj.has_next %}
												<a href="?page={{ page_obj.next_page_number }}">Next</a>
											{% endif %}
										{% endif %}
									{% endwith %}
							</span>
						</p>
					</td>
				</tr>
			</tfoot>
			{% else %}
			<tr class="">
				<td
					colspan="11"
					class="text-center">
					No Student Assessments Found
				</td>
			</tr>
			{% endif %}
		</table>
		
		{% for sectio in letter.student_sections.all %}
			{{section.section.name}}
		{% endfor %}
			
	</div>
</div>
{% endblock main %}